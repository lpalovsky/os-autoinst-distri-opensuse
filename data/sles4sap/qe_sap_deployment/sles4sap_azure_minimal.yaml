provider: 'azure'
apiver: 2
terraform:
  provider: 'azure'
  variables:
    # GENERAL VARIABLES #
    az_region: "%PUBLIC_CLOUD_REGION%"
    #os_image: "%PUBLIC_CLOUD_OS_IMAGE%"
    #hana_major_version: "%HANA_OS_MAJOR_VER%"
    admin_user: "cloudadmin"
    public_key : "~/.ssh/id_rsa.pub"
    private_key: "~/.ssh/id_rsa"
    sles4sap_uri: "https://%STORAGE_ACCOUNT_NAME%.blob.core.windows.net/sle-images/%SLE_IMAGE%"
    storage_account_name: "%STORAGE_ACCOUNT_NAME%"
    storage_account_key: "%STORAGE_ACCOUNT_KEY%"

    # BASTION
    bastion_enabled: "false"

    # HANA
    hana_count: 1
    hana_ha_enabled: "false"
    vm_size: "Standard_D2s_v3"

ansible:
  hana_urls:
    - "%HANA_SAR%"
    - "%HANA_CLIENT_SAR%"
    - "%HANA_SAPCAR%"
  create:
    - registration.yaml -e reg_code=%SCC_REGCODE_SLES4SAP% -e email_address=""
    - pre-cluster.yaml
    - sap-hana-preconfigure.yaml -e use_sapconf=${SAPCONF}
    - cluster_sbd_prep.yaml
    - sap-hana-storage.yaml
    - sap-hana-download-media.yaml
    - sap-hana-install.yaml
    - sap-hana-system-replication.yaml
    - sap-hana-system-replication-hooks.yaml
    - sap-hana-cluster.yaml
  destroy:
    - deregister.yaml
  variables:
    SAPCONF: true